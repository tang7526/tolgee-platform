"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("@tolgee/web");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(e);const s={useSuspense:!0},o=r.default.createContext(void 0);let a;const l=()=>{const t=e.useContext(o)||a;if(!t)throw new Error("Couldn't find tolgee instance, did you forgot to use `TolgeeProvider`?");return t},u=()=>{const[t,n]=e.useState(0);return{instance:t,rerender:e.useCallback((()=>{n((e=>e+1))}),[n])}},c=(n,r)=>{const{tolgee:s,options:o}=l(),a=t.getFallback(n),c=t.getFallbackArray(a).join(":"),i=Object.assign(Object.assign({},o),r),{rerender:d,instance:f}=u(),p=e.useRef(),b=e.useRef([]);b.current=[];const g=s.isLoaded(a);e.useEffect((()=>{const e=s.onNsUpdate(d);return p.current=e,g||e.subscribeNs(a),b.current.forEach((t=>{e.subscribeNs(t)})),()=>{e.unsubscribe()}}),[g,c,s]),e.useEffect((()=>(s.addActiveNs(a),()=>s.removeActiveNs(a))),[c,s]);const v=e.useCallback((e=>{var t;const n=null!==(t=e.ns)&&void 0!==t?t:null==a?void 0:a[0];return(e=>{var t;b.current.push(e),null===(t=p.current)||void 0===t||t.subscribeNs(e)})(n),s.t(Object.assign(Object.assign({},e),{ns:n}))}),[s,f]);if(i.useSuspense&&!g)throw s.addActiveNs(a,!0);return{t:v,isLoading:!g}},i=e=>{if(!e)return;const t={};return Object.entries(e||{}).forEach((([e,n])=>{if("function"==typeof n)t[e]=e=>n(d(e));else if(r.default.isValidElement(n)){const s=n;t[e]=e=>void 0!==s.props.children?r.default.cloneElement(s):r.default.cloneElement(s,{},d(e))}else t[e]=n})),t},d=e=>Array.isArray(e)?r.default.Children.toArray(e):e;exports.GlobalContextPlugin=e=>t=>(a={tolgee:t,options:Object.assign(Object.assign({},s),e)},t),exports.T=e=>{const t=e.keyName||e.children;void 0===t&&console.error("T component: keyName not defined");const n=e.defaultValue||(e.keyName?e.children:void 0),{t:s}=c(),o=d(s({key:t,params:i(e.params),defaultValue:n,noWrap:e.noWrap,ns:e.ns}));return r.default.createElement(r.default.Fragment,null,o)},exports.TolgeeProvider=({tolgee:t,options:n,children:a,fallback:l})=>{const[u,c]=e.useState(!t.isLoaded());e.useEffect((()=>(t.run().finally((()=>{c(!1)})),()=>{t.stop()})),[t]);const i=Object.assign(Object.assign({},s),n);return i.useSuspense?r.default.createElement(o.Provider,{value:{tolgee:t,options:i}},u?l:r.default.createElement(e.Suspense,{fallback:l||null},a)):r.default.createElement(o.Provider,{value:{tolgee:t,options:i}},u?l:a)},exports.TolgeeProviderContext=o,exports.useTolgee=t=>{const{tolgee:n}=l(),{rerender:r}=u();return e.useEffect((()=>{const e=null==t?void 0:t.map((e=>n.on(e,r)));return()=>{null==e||e.forEach((e=>e.unsubscribe()))}}),[null==t?void 0:t.join(":")]),n},exports.useTranslate=(n,r)=>{const{t:s,isLoading:o}=c(n,r);return{t:e.useCallback(((...e)=>{const n=t.getTranslateProps(...e);return s(n)}),[s]),isLoading:o}},Object.keys(t).forEach((function(e){"default"===e||exports.hasOwnProperty(e)||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})}));
//# sourceMappingURL=tolgee-react.cjs.min.js.map
